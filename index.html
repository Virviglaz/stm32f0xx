<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Doxygen with github: STM32F0xx open source highly efficient peripheral driver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Doxygen with github
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">STM32F0xx open source highly efficient peripheral driver </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a> This drivers is a simplified and highly enchansed alternative to the official HAL/SPL ST's drivers. It is specially made to be used with realtime operational systems as well as with the bare metall platforms.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Clock setup</h1>
<div class="fragment"><div class="line"><span class="comment">/* Setup clocking from HSIxPLL for 16 MHz (8..48 MHz) */</span></div>
<div class="line">rcc_enable_hsi_pll(4);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2"></a>
GPIO example</h1>
<div class="fragment"><div class="line">gpio_output_init(PB01, PUSHPULL_OUTPUT, GPIO_LOW_SPEED);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* set pin HIGH */</span></div>
<div class="line">gpio_set(PB01);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* set pin LOW */</span></div>
<div class="line">gpio_clr(PB01);</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md3"></a>
UART example</h1>
<div class="fragment"><div class="line"><span class="comment">/* pointer to uart settings and buffers */</span></div>
<div class="line"><a class="code hl_struct" href="structuart__dev.html">uart_dev</a> uart;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* uart rx handler, executed from ISR when data is filled or end of a line detected */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> uart_rx_handler(<span class="keywordtype">char</span> *buffer, uint16_t size, <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">/* your code here, data is stored in buffer */</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* find uart connected to GPIOB, pin 6 (can be tx or rx pin), init for 9600 bod */</span></div>
<div class="line">uart = find_uart_dev(PB6, 9600);</div>
<div class="line">or</div>
<div class="line"><span class="comment">/* use UART1 insted if you know where it is connected to and init it for 9600 bod */</span></div>
<div class="line">uart = get_uart_dev(1, 9600);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* enabling receiver */</span></div>
<div class="line">uart_enable_rx(uart, rx_buf, <span class="keyword">sizeof</span>(rx_buf),</div>
<div class="line">        uart_rx_handler, 0);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* send data using dma or interrupt depends of dma availability */</span></div>
<div class="line">uart_send_string(uart, <span class="stringliteral">&quot;Hallo world!\r\n&quot;</span>);</div>
<div class="ttc" id="astructuart__dev_html"><div class="ttname"><a href="structuart__dev.html">uart_dev</a></div><div class="ttdoc">Uart device definition struct including uart buffers.</div><div class="ttdef"><b>Definition</b> uart.h:102</div></div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md4"></a>
SPI example</h1>
<p>If DMA is available, transfer will be done using DMA. Otherwise interrupt will be used. </p><div class="fragment"><div class="line"><span class="comment">/* use SPI1 and initialize for 10MHz and idle clock mode */</span></div>
<div class="line">spi_dev spi = get_spi_dev(1, 10000000, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* send 16 bytes to 0xEE register of some chip connected to PA4 */</span></div>
<div class="line">spi_write_reg(spi, PA4, 0xEE, (<span class="keywordtype">void</span> *)rx_buf, 16);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* receive 16 bytes from 0xEE register of some chip connected to PA4 */</span></div>
<div class="line">spi_read_reg(spi, PA4, 0xEE, (<span class="keywordtype">void</span> *)rx_buf, 16);</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md5"></a>
I2C example</h1>
<div class="fragment"><div class="line"><span class="comment">/* init I2C1 in fast mode (true == fast, false == normal)</span></div>
<div class="line"><span class="comment">i2c_dev i2c = i2c = get_i2c_dev(1, true);</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/* read 10 bytes of data from MPU6050 address 0x68 register 0xC3 in buffer */</span></div>
<div class="line">i2c_read_reg(i2c, 0x68, 0xC3, buf, 10);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* write 10 bytes of data from buffer to MPU6050 at 0x68 address */</span></div>
<div class="line">i2c_write_reg(i2c, 0x68, 0xC3, buf, 10);</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md6"></a>
DELAYS</h1>
<p>Simply use, do not init anything. </p><div class="fragment"><div class="line"><span class="comment">/* wait for 250ms */</span></div>
<div class="line">delay_ms(250);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* wait for 250us */</span></div>
<div class="line">delay_us(250);</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md7"></a>
ADC example</h1>
<div class="fragment"><div class="line"><span class="comment">/* channel0 will be used */</span></div>
<div class="line">adc_dev adc_ch0 = get_adc_dev(0);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* convert and read the value */</span></div>
<div class="line">adc_res = adc_read(adc_ch0, 7);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* read internal temperature value */</span></div>
<div class="line"><span class="keywordtype">double</span> t = adc_read_temp();</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* read vref value */</span></div>
<div class="line"><span class="keywordtype">double</span> v = adc_read_vref();</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md8"></a>
Timer example</h1>
<div class="fragment"><div class="line"><span class="comment">/* get handler and initialize timer 7 for 2.5kHz */</span></div>
<div class="line">tim_dev tim7 = get_tim_dev(7, 2500, 0);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* this code will be run by the interrupt */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> tim_isr(<span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* invert pin state (LED flash) */</span></div>
<div class="line">    gpio_inv(PA4);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* enable timer interrupt */</span></div>
<div class="line">tim_enable_interrupt(tim7, tim_isr, 0);</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md9"></a>
PWM example</h1>
<div class="fragment"><div class="line"><span class="comment">/* use timer 14 with 2500kHz frequency */</span></div>
<div class="line">tim_dev tim14 = get_tim_dev(14, 2500, 0);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* set manually the timebase (prescaller and period) */</span></div>
<div class="line">tim_set_timebase(tim14, 1000, 1500);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* enalbe PWM output at PB1 or if defined TIM14PWM1_REMAP at PA4 */</span></div>
<div class="line">tim_pwm_enable(tim14, 1, 1000);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* change the duty cycle */</span></div>
<div class="line">tim_pwm_set_duty(tim14, 1, 200);</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md10"></a>
CRC example</h1>
<div class="fragment"><div class="line"><span class="comment">/* calculate CRC32 of whole mcu flash memory */</span></div>
<div class="line">uint32 crc32 = crc((<span class="keywordtype">void</span> *)0x8000000, 0x40000 / 4, <span class="keyword">sizeof</span>(uint32_t));</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
